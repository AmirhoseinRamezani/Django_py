{% extends 'base.html'%}
{% load static %}
{% block content %}

<!-- start banner Area -->
<section class="banner-area relative">
    <div class="overlay overlay-bg"></div>
    <div class="container">
        <div class="row fullscreen align-items-center justify-content-between">
            <div class="col-lg-6 col-md-6 banner-left">
                <h6 class="text-white">Away from monotonous life</h6>
                <h1 class="text-white">Magical Travel</h1>
                <p class="text-white">
                    If you are looking at blank cassettes on the web, you may be very confused at the difference in
                    price. You may see some for as low as $.17 each.
                </p>
                <a href="{% url 'tours:tour_list' %}" class="primary-btn text-uppercase">Discover Our Tours</a>
            </div>
        </div>
    </div>
</section>
<!-- End banner Area -->

<!-- Start popular-destination Area -->
<section class="popular-destination-area section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">Popular Destinations</h1>
                    <p>We all live in an age that belongs to the young at heart. Life that is becoming extremely
                        fast, day.</p>
                </div>
            </div>
        </div>
        <div class="row">
            {% for destination in popular_destinations %}
            <div class="col-lg-4">
                <div class="single-destination relative">
                    <div class="thumb relative">
                        <div class="overlay overlay-bg"></div>
                        <img class="img-fluid" src="{{ destination.featured_image.url }}" alt="{{ destination.name }}">
                    </div>
                    <div class="desc">
                        <a href="#" class="price-btn">Explore</a>
                        <h4>{{ destination.name }}</h4>
                        <p>{{ destination.country }}</p>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center">
                <p>No popular destinations available.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- End popular-destination Area -->

<!-- Start other-issue Area (Services) -->
<section class="other-issue-area section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-9">
                <div class="title text-center">
                    <h1 class="mb-10">Our Services</h1>
                    <p>We all live in an age that belongs to the young at heart. Life that is.</p>
                </div>
            </div>
        </div>
        <div class="row">
            {% for service in services %}
            <div class="col-lg-3 col-md-6">
                <div class="single-other-issue">
                    <div class="thumb">
                        {% if service.image %}
                        <img class="img-fluid" src="{{ service.image.url }}" alt="{{ service.title }}">
                        {% else %}
                        <img class="img-fluid" src="{% static 'img/o1.jpg' %}" alt="{{ service.title }}">
                        {% endif %}
                    </div>
                    <a href="#">
                        <h4>{{ service.title }}</h4>
                    </a>
                    <p>{{ service.description|truncatewords:20 }}</p>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center">
                <p>No services available.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- End other-issue Area -->

<!-- Start Featured Pages Area -->
<section class="featured-pages-area section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">اطلاعات مهم</h1>
                    <p>آخرین اخبار و اطلاعات مهم شرکت مسافرتی ما</p>
                </div>
            </div>
        </div>
        <div class="row">
            {% for page in featured_pages %}
            <div class="col-lg-3 col-md-6">
                <div class="single-featured-page">
                    <div class="thumb">
                        {% if page.featured_image %}
                        <img class="img-fluid" src="{{ page.featured_image.url }}" alt="{{ page.title }}">
                        {% else %}
                        <img class="img-fluid" src="{% static 'img/p1.jpg' %}" alt="{{ page.title }}">
                        {% endif %}
                    </div>
                    <div class="details">
                        <a href="{{ page.get_absolute_url }}">
                            <h4>{{ page.title }}</h4>
                        </a>
                        <p>{{ page.excerpt|default:page.content|striptags|truncatewords:15 }}</p>
                        <a href="{{ page.get_absolute_url }}" class="primary-btn">مطالعه بیشتر</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- End Featured Pages Area -->

<!-- Start Important Posts Area -->
<section class="important-posts-area section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">آخرین اخبار و تخفیف‌ها</h1>
                    <p>از آخرین اخبار و پیشنهادات ویژه ما مطلع شوید</p>
                </div>
            </div>
        </div>
        <div class="row">
            {% for post in important_posts %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card post-card h-100">
                    <img src="{{ post.image.url }}" class="card-img-top" alt="{{ post.title }}">
                    <div class="card-body">
                        <div class="tags mb-2">
                            {% for category in post.categories.all|slice:":2" %}
                            <span class="badge badge-primary">{{ category.name }}</span>
                            {% endfor %}
                        </div>
                        <h5 class="card-title">{{ post.title }}</h5>
                        <p class="card-text">{{ post.content|striptags|truncatewords:20 }}</p>
                        <div class="post-meta">
                            <small class="text-muted">{{ post.published_date|date:"Y/m/d" }}</small>
                            <span class="views"><i class="fa fa-eye"></i> {{ post.counted_views }}</span>
                        </div>
                        <a href="{{ post.get_absolute_url }}" class="primary-btn mt-3">مطالعه بیشتر</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- End Important Posts Area -->

<!-- Start testimonial Area -->
<section class="testimonial-area section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">Testimonials from our Clients</h1>
                    <p>With the exception of Nietzsche, no other madman has contributed so much to human sanity as has.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="active-testimonial">
                {% for testimonial in testimonials %}
                <div class="single-testimonial item">
                    <div class="desc">
                        <p>{{ testimonial.content }}</p>
                    </div>
                    <div class="writer">
                        <div class="thumb">
                            {% if testimonial.user.profile.profile_image %}
                            <img src="{{ testimonial.user.profile.profile_image.url }}" alt="{{ testimonial.user.get_full_name }}">
                            {% else %}
                            <img src="{% static 'img/t1.jpg' %}" alt="{{ testimonial.user.get_full_name }}">
                            {% endif %}
                        </div>
                        <div class="info">
                            <h4>{{ testimonial.user.get_full_name|default:testimonial.user.username }}</h4>
                            <p>{{ testimonial.user.profile.job_title|default:"Traveler" }}</p>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="single-testimonial item">
                    <div class="desc">
                        <p>No testimonials available yet.</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
<!-- End testimonial Area -->

<!-- Start blog Area -->
<section class="blog-slider-section section-gap">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-70 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">آخرین مطالب بلاگ</h1>
                    <p>جدیدترین مقالات و اخبار سفر</p>
                </div>
            </div>
        </div>
        
        <!-- نمایش تعداد پست‌ها -->
        <div class="alert alert-info mb-4 text-center">
            <strong>آخرین مطالب:</strong> 
            <span class="badge badge-primary">{{ featured_posts|length }} پست جدید</span>
        </div>
        
        {% if featured_posts %}
        <div class="simple-blog-slider">
            <div class="blog-slider-container">
                {% for post in featured_posts %}
                <div class="blog-slide-item">
                    <div class="blog-card">
                        <div class="blog-image">
                            {% if post.image %}
                            <img src="{{ post.image.url }}" alt="{{ post.title }}">
                            {% else %}
                            <img src="{% static 'img/default-post.jpg' %}" alt="{{ post.title }}">
                            {% endif %}
                            <div class="blog-overlay">
                                <a href="{% url 'blog:single' post.id %}" class="read-more-btn">
                                    <i class="fa fa-eye"></i>
                                </a>
                            </div>
                        </div>
                        <div class="blog-content">
                            <div class="blog-meta">
                                <span class="date">
                                    <i class="fa fa-calendar"></i>
                                    {{ post.published_date|date:"Y/m/d" }}
                                </span>
                                <span class="views">
                                    <i class="fa fa-eye"></i>
                                    {{ post.counted_views }}
                                </span>
                            </div>
                            <h3 class="blog-title">
                                <a href="{% url 'blog:single' post.id %}">
                                    {{ post.title|truncatewords:8 }}
                                </a>
                            </h3>
                            <p class="blog-excerpt">
                                {{ post.excerpt|default:post.content|striptags|truncatewords:15 }}
                            </p>
                            <a href="{% url 'blog:single' post.id %}" class="primary-btn">
                                مطالعه بیشتر
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- دکمه مشاهده همه پست‌ها -->
        <div class="text-center mt-4">
            <a href="{% url 'blog:index' %}" class="btn btn-outline-primary">
                مشاهده همه پست‌ها
            </a>
        </div>
        {% else %}
        <div class="alert alert-warning text-center">
            <p>هنوز پستی منتشر نشده است.</p>
            <a href="{% url 'blog:index' %}" class="btn btn-primary">برو به بلاگ</a>
        </div>
        {% endif %}
    </div>
</section>

<style>
.simple-blog-slider {
    overflow: hidden;
}

.blog-slider-container {
    display: flex;
    gap: 20px;
    overflow-x: auto;
    padding: 10px 0;
    scrollbar-width: thin;
}

.blog-slider-container::-webkit-scrollbar {
    height: 8px;
}

.blog-slider-container::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
}

.blog-slider-container::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 10px;
}

.blog-slider-container::-webkit-scrollbar-thumb:hover {
    background: #555;
}

.blog-slide-item {
    flex: 0 0 300px;
}

.blog-card {
    border: 1px solid #e9ecef;
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.3s ease;
    height: 100%;
}

.blog-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}

.blog-image {
    position: relative;
    height: 200px;
    overflow: hidden;
}

.blog-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.blog-card:hover .blog-image img {
    transform: scale(1.1);
}

.blog-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.blog-card:hover .blog-overlay {
    opacity: 1;
}

.read-more-btn {
    color: white;
    font-size: 20px;
    text-decoration: none;
}

.blog-content {
    padding: 20px;
}

.blog-meta {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 12px;
    color: #666;
}

.blog-meta span {
    display: flex;
    align-items: center;
    gap: 5px;
}

.blog-title {
    font-size: 16px;
    margin-bottom: 10px;
    line-height: 1.4;
}

.blog-title a {
    color: #333;
    text-decoration: none;
}

.blog-title a:hover {
    color: #007bff;
}

.blog-excerpt {
    font-size: 14px;
    color: #666;
    line-height: 1.6;
    margin-bottom: 15px;
}
</style>
<!-- End recent-blog Area -->

{% endblock %}