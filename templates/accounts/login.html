<!-- templates/accounts/login.html -->
{% extends 'accounts/base_auth.html' %}
{% load static %}

{% block title %}ورود{% endblock %}

{% block content %}
<h3 class="kpx_authTitle">ورود یا <a href="{% url 'accounts:signup' %}">ثبت نام</a></h3>

<!-- نمایش پیام‌ها -->
{% if messages %}
<div class="messages mt-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        <i class="fas 
            {% if message.tags == 'success' %}fa-check-circle
            {% elif message.tags == 'error' %}fa-exclamation-circle
            {% else %}fa-info-circle{% endif %} me-2"></i>
        {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- نمایش خطاهای فرم -->
{% if form.errors %}
<div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong><i class="fas fa-exclamation-triangle me-2"></i>خطا!</strong> 
    لطفا اطلاعات وارد شده را بررسی کنید.
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
{% endif %}

<div class="row kpx_row-sm-offset-3">
    <div class="col-12">	
        <form class="kpx_loginForm" action="{% url 'accounts:login' %}" autocomplete="off" method="POST">
            {% csrf_token %}
            
            {% if request.GET.next %}
            <input type="hidden" name="next" value="{{ request.GET.next }}">
            {% endif %}
            
            <!-- فیلد نام کاربری -->
            <div class="form-group">
                <div class="input-group">
                    <input type="text" name="username" class="form-control {% if form.username.errors %}is-invalid{% endif %}" 
                           placeholder="نام کاربری یا ایمیل" value="{{ form.username.value|default:'' }}" required>
                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                    {% if form.username.errors %}
                    <div class="invalid-feedback">
                        {{ form.username.errors.0 }}
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- فیلد رمز عبور -->
            <div class="form-group">
                <div class="input-group">
                    <input type="password" name="password" class="form-control {% if form.password.errors %}is-invalid{% endif %}" 
                           placeholder="رمز عبور" required>
                    <span class="input-group-addon"><i class="fa fa-key"></i></span>
                    {% if form.password.errors %}
                    <div class="invalid-feedback">
                        {{ form.password.errors.0 }}
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-group">
                <div class="row">
                    <div class="col-6">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" id="remember_me" name="remember_me" checked>
                            <label class="custom-control-label" for="remember_me">مرا به خاطر بسپار</label>
                        </div>
                    </div>
                    <!-- <div class="col-6 text-left">
                        <p class="forgot-password">
                            <a href="#">رمز عبور را فراموش کرده‌اید؟</a>
                        </p>
                    </div> -->
                </div>
            </div>

            <button class="btn btn-lg btn-outline-primary btn-block" type="submit">
                <i class="fa fa-sign-in me-2"></i>ورود به حساب
            </button>
        </form>
    </div>
</div>

<div class="row kpx_row-sm-offset-3 mt-4">
    <div class="col-12 text-center">
        <p class="mb-0">
            حساب کاربری ندارید؟ 
            <a href="{% url 'accounts:signup' %}" class="font-weight-bold">ثبت نام کنید</a>
        </p>
    </div>
</div>
{% endblock %}